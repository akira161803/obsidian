
Date: 2025-09-27
Tags: 
Links:  [[WSA]], [[Business Logic Vulnerabilities]]

***

1. 負数の商品は送れない。
2. →限界まで送ってみる。**整数オーバーフロー**狙い。


## 整数オーバーフローとは

多くのプログラミング言語では、数値を格納する変数の型（データ型）にサイズの上限があります。例えば、32ビット符号付き整数型の場合、表現できる最大値は `2,147,483,647` です。この最大値を超えてさらに数を足そうとすると、値が一周して最小値である `-2,147,483,648` になってしまいます。これを整数オーバーフローと呼びます。

攻撃の意図 : 
このラボのバックエンドシステムは、カートの合計金額を32ビット符号付き整数で管理しています。フロントエンドでは一度に追加できる数量を99個に制限していますが、サーバーサイドではそのチェックが甘く、リクエストを何度も送ればカートに商品を追加し続けられます。「**Null payloads**」は、ペイロード（この場合は数量）を変化させずに、同じリクエストを何度も送信するための設定です。これにより、`quantity=99`のリクエストを大量に送りつけ、合計金額を意図的に最大値以上にすることでオーバーフローを発生させ、価格をマイナスに反転させています。


***
# References

https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-low-level