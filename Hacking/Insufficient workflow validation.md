
Date: 2025-09-27
Tags: 
Links:  [[WSA]], [[Business Logic Vulnerabilities]]

***

イベントのシーケンス（順序）に関する思い込みは、同じワークフローや機能内であっても、広範囲な問題を引き起こす可能性があります。攻撃者は、Burp ProxyやRepeaterのようなツールを使い、一度リクエストを観測すれば、それを意のままに再送信したり、強制ブラウジングを用いてサーバーとの任意のやり取りを好きな順序で実行したりできます。これにより、アプリケーションが予期しない状態にある間に、異なるアクションを完了させることが可能になります。

この種の欠陥を特定するためには、強制ブラウジングを用いて、意図しない順序でリクエストを送信すべきです。例えば、特定のステップをスキップしたり、単一のステップに複数回アクセスしたり、前のステップに戻ったりすることが考えられます。異なるステップがどのようにアクセスされるかに注意してください。多くの場合、特定のURLにGETやPOSTリクエストを送信するだけですが、時には同じURLに異なるパラメータセットを送信することで各ステップにアクセスできることもあります。すべてのロジックの欠陥と同様に、開発者がどのような仮定を置いているか、そして攻撃対象領域がどこにあるかを特定するように努めてください。そうすれば、これらの仮定を侵害する方法を探すことができます。

この種のテストは、期待される変数がnull値や未初期化の値を持つため、しばしば例外を引き起こすことに注意してください。部分的に定義された、あるいは一貫性のない状態で特定の場所に到達することも、アプリケーションがエラーを出す原因となり得ます。この場合、遭遇するエラーメッセージやデバッグ情報に細心の注意を払ってください。これらは情報漏洩の貴重な源となり、攻撃を微調整したり、バックエンドの挙動に関する重要な詳細を理解したりするのに役立ちます。


## Lab : 
1. クレジット内で買える商品を買うと、`GET /cart/order-confirmation?order-confirmation=true`とともに送られる。
2. 商品をカートに入れて上のURLを送ると金が足りなくても購入できる。


***
# References

https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-insufficient-workflow-validation